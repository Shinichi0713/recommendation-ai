産業界において定期的なメンテナンスであったり、状態監視に対するニーズがあります。
人で検知することも勿論できますが、出来れば人がなくても自動で、良い精度で検出したいものです。
そんな時に役に立つ手法が異常検知です。

異常検知の手法には学習用のデータの扱いによってカテゴリー分類が出来ます。
大きく分けて、 **「教師あり」「教師なし（今回のRPCAなど）」「半教師あり」** の3つのアプローチに整理できます。
今回はそれぞれのカテゴリについて説明します。

## 各手法概要

### 1. 教師なし学習 (Unsupervised Learning)

今回の **RPCA** や **PCA**、**IALM** などが属するカテゴリーです。

* **考え方**: データの中に「正常」と「異常」の両方が混ざっていることを前提とし、データの統計的な性質（低ランク性や密度など）から、他と違う浮いた存在を見つけ出します。
* **必要なデータ**: ラベルなしの生データのみ。
* **主な手法**:
* **RPCA / PCA**: データの主要な成分（背景）から外れるものを検知。
* **Isolation Forest**: データをランダムに分割し、少ない回数で孤立するものを異常とみなす。
* **K-Means / 混合ガウスモデル (GMM)**: クラスタリングし、どの群れにも属さないものを検知。


* **メリット**: 事前の準備が楽。未知の異常（見たことがないキズ）にも対応できる。
* **デメリット**: 正常データがあまりに多様だと、正常な変化を異常と誤検知しやすい。


### 2. 半教師あり学習 (Semi-Supervised Learning)

製造現場や外観検査で、**最も現実的でよく使われる手法**です。

* **考え方**: **「正常なデータだけ」** を大量に学習させ、「正常とは何か」を深く理解させます。本番で「正常から外れたもの」が来たら異常と判定します。
* **必要なデータ**: 大量の「正常」データのみ（異常データは不要）。
* **主な手法**:
* **One-Class SVM (OCSVM)**: 正常データの境界線を引く。
* **AutoEncoder (深層学習)**: 正常画像だけを完璧に再現できるように学習。異常が来ると再現に失敗（再構成誤差が発生）する。
* **PatchCore / PaDiM**: 最新の画像異常検知。正常な特徴の「分布」を記憶する。


* **メリット**: 異常データが1件もなくても始められる。
* **デメリット**: 正常データのバリエーション（照明変化など）を全て網羅しておく必要がある。


### 3. 教師あり学習 (Supervised Learning)

一般的な「AIの画像分類」と同じ考え方です。
異常のカテゴリまで教師データとして用意できるのであればこの手法が確実と言えるかもしれません。

* **考え方**: 「これが正常」「これがキズA」「これが汚れB」と、正解ラベルを貼ったデータを学習させます。
* **必要なデータ**: 大量の「正常」データ ＋ 大量の「異常」データ。
* **主な手法**:
* **CNN (ResNetなど)**: 画像分類。
* **YOLO / SSD**: 異常箇所の物体検出。
* **U-Net**: 異常箇所のセグメンテーション（ピクセル単位の特定）。


* **メリット**: 精度が非常に高く、異常の種類（キズか汚れか）まで特定できる。
* **デメリット**: 異常データを集めるのが大変（通常、異常は滅多に起きないため）。学習した「特定の異常」以外には反応しにくい。

## ユースケース

「教師なし」「半教師あり」「教師あり」の3つの手法は、現場のデータの集まり具合や「何を検知したいか」によって、使い分けられています。それぞれの具体的なユースケースを紹介します。

### 1. 教師なし学習（Unsupervised）の事例

**「何が異常か分からないが、とにかく変なものを見つけたい」** という初期段階や、動的な変化を扱う場面で使われます。

* **監視カメラの動体検知（RPCAの代表例）**:
* **内容**: 24時間録画されている映像から、背景（動かないもの）を分離し、横切る不審者や車両（スパースな異常）だけを抜き出します。
* **理由**: 「不審者の画像」を事前に学習させなくても、背景と違う動きがあれば即座に反応できるためです。


* **サーバーのログ監視 / 不正アクセス検知**:
* **内容**: ネットワークのトラフィックを監視し、普段の通信パターン（低ランクな定常状態）から大きく外れた突発的なアクセス（スパースなスパイク）を検知します。
* **理由**: 新種のサイバー攻撃（未知の異常）は教師あり学習では防げないため、統計的な「浮いた動き」を捉える手法が有効です。


### 2. 半教師あり学習（Semi-supervised）の事例

**「正常な状態は完璧に定義できるが、異常のパターンが無限にある」** という製造現場で主流です。

* **半導体や液晶パネルの外観検査**:
* **内容**: 正常な回路パターンの画像を数千枚学習させた「AutoEncoder」などのモデルを使用します。
* **理由**: 正常なパターンは一定ですが、キズ・欠け・異物・変色など、異常の形は無限にあり、その全てを教師データとして集めるのは不可能だからです。


* **インフラ（橋梁・トンネル）のひび割れ検知**:
* **内容**: 健全なコンクリート表面だけを学習し、そこから外れたテクスチャ（ひび、漏水）を異常として特定します。
* **理由**: 崩落寸前の深刻なひび割れデータなどは頻繁に手に入らないため、「正常以外はすべて異常」とみなすアプローチが安全です。


### 3. 教師あり学習（Supervised）の事例

**「検知したい異常の形が決まっており、それを種類別に分類したい」** 場合に最強の力を発揮します。

* **医療画像診断（X線、MRI、病理画像）**:
* **内容**: 「良性腫瘍」と「悪性腫瘍」の画像を専門医がラベル付けし、CNN（深層学習）で学習させます。
* **理由**: 異常（がん）の種類によって治療法が異なるため、単に「変なものがある」だけでなく「これは何か」を特定する必要があるためです。


* **食品の自動選別ライン**:
* **内容**: コンベアを流れる果物などを、「形が悪い」「色が悪い」「虫食いがある」といったカテゴリ別に学習させたモデル（YOLOなど）で仕分けます。
* **理由**: 過去の選別基準が明確で、それぞれの異常パターンの画像が十分に確保できるため、最も高い精度が出せます。


### 状況ごとにどのアプローチを選ぶべきか？

| 状況 | 推奨手法 | 理由 |
| --- | --- | --- |
| **データが全くない、とりあえず始めたい** | **教師なし（RPCA等）** | 準備なしで「他と違うもの」を探せる。 |
| **正常品は山ほどあるが、不良品は滅多に出ない** | **半教師あり** | 「正常とは何か」を教え込むのが最も効率的。 |
| **過去の不良品データが大量に蓄積されている** | **教師あり** | 特定の不良を100%に近い精度で見極められる。 |


## トレンド
技術的というよりは応用のトレンドですが。
最近の産業界における異常検知は、単に「変なものを見つける」段階から、　**現場で本当に使える（高精度・低コスト・説明可能）**　段階へと進化しています。

主要なトレンドを4つのキーワードで整理しました。

### 1. 「正常」だけを極める：Deep Anomaly Detection の進化

かつては教師あり学習が主流でしたが、現在は　**「半教師あり学習（正常データのみ学習）」**　が産業界のスタンダードです。特に画像分野では以下の手法がトレンドです。

* **PatchCore / PaDiM**: 正常な画像の「特徴」を記憶し、それと違う部分をピクセル単位で特定します。数枚〜数十枚の正常画像があれば運用を開始できるため、多品種少量生産の現場で非常に重宝されています。
* **特徴**: AutoEncoderよりも解像度が高く、数ミリの小さなキズも高精度に検出可能です。

### 2. 深層展開（Deep Unfolding）：数理モデルとAIの融合

今回あなたが学んでいる **RPCAやIALMを「深層学習の層」として組み込む**技術です。

* **仕組み**: RPCAのような「数学的な正しさ」と、Deep Learningの「データ適応力」をいいとこ取りします。
* **メリット**: 従来のAIは「なぜそう判断したか」が不明な「ブラックボックス」になりがちですが、この手法は　**計算プロセスが明確（SVTを通っている等）なため、品質保証が厳しい製造業で採用が進んでいます。**

### 3. エッジAIとリアルタイム性

クラウドにデータを飛ばさず、現場のカメラやセンサーのすぐ横（エッジ）で判定を行う流れです。

* **トレンド**: 超軽量なアルゴリズムや、専用のAIチップ（NVIDIA Jetson等）を用いることで、コンベア上の高速な製品移動（ミリ秒単位）に合わせてリアルタイムで異常を弾きます。
* **背景**: 通信遅延の解消だけでなく、現場のデータを外部に出したくないというセキュリティ上の理由もあります。

### 4. マルチモーダル異常検知

「画像だけ」ではなく、複数のセンサー情報を組み合わせて判断する手法です。

* **具体例**:
* **外観（画像）＋ 異音（マイク）＋ 振動（加速度センサー）**


* **効果**: 「見た目は正常だが、内部で異音がしている」といった、1つのセンサーでは見逃していた複合的な予兆（故障の兆候）を捉えられるようになっています。

