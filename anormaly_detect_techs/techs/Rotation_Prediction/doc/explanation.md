はい、その通りです。Rotation Predictionは、**学習（Training）には「正常画像のみ」**を使用します。

「何が異常か」を教えるのではなく、**「正常な画像が、どの向きにあるのが自然か」**を徹底的にモデルに叩き込むのがこの手法のキモです。

---

### 学習とテストのデータの使い分け

| **フェーズ**           | **使用するデータ**  | **モデルが行うこと**                                                      |
| ---------------------------- | ------------------------- | ------------------------------------------------------------------------------- |
| **学習 (Train)**       | **正常画像のみ**    | 画像を0°, 90°, 180°, 270°に回転させ、その角度（クラス）を当てる特訓をする。 |
| **テスト (Inference)** | **正常 + 異常画像** | 回転させた画像を入力し、角度を正しく当てられるかチェックする。                  |

---

### なぜ正常データだけで異常が分かるのか？

この手法の背景には、**「正常な構造を深く理解していないと、向きを正しく判定できないはずだ」**という仮定があります。

1. 正常な場合：
   モデルは学習を通じて、「この部品は上にこの突起があるから0度だ」「文字が逆さまだから180度だ」という正常な形状ルールを覚えます。そのため、テスト時も高い自信（確信度）で角度を言い当てます。
2. 異常な場合：
   例えば「欠損がある」「見たこともない汚れがついている」画像が入ってくると、モデルが覚えたルールが通用しません。その結果、**「どの角度に見えるかよく分からない（確信度が低い）」あるいは「間違った角度を答える」**という反応を示します。

---

### 実務でのポイント：向きに意味があるか？

この手法を採用するかどうかの判断基準は、**「その物体に『正しい向き』が存在するかどうか」**です。

* **有効な例** : 電子基板、文字があるラベル、特定の方向に模様がある建材。
* これらは向きが変わると「意味」が変わるため、モデルが学習しやすいです。
* **不向きな例** : 真ん丸の錠剤、均一な粉体、ランダムなノイズのようなテクスチャ。
* これらは回転させても見た目が変わらないため、モデルがクイズに正解できず、学習が成立しません。

### 次のステップ：他の手法との使い分け

もし扱うデータに向きが重要でない（例えば丸い部品の表面キズなど）場合は、以前ご紹介した **Deep RX** や **PaDiM** の方が、正常データの「質感」の分布を直接捉えるため、より効果的です。

あなたが今想定されているデータは、特定の「向き」や「決まった形」がある製品でしょうか？それとももっとランダムな模様のようなものでしょうか？
