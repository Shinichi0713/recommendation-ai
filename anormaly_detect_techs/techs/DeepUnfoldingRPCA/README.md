行列分解をベースとした異常検知は、統計学的な古典手法から最新の深層学習との融合まで、非常に豊かな歴史があります。

主要な手法を年代順に整理してリストアップします。

### 行列分解系 異常検知アルゴリズムの系譜

| 手法名                             | 登場時期                             | 特徴                                                                                   | ここがすごい！                                                                                   |
| ---------------------------------- | ------------------------------------ | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| **PCA** (主成分分析)         | 1901年~ (異常検知への応用は1970年代) | データの分散が最大になる方向に射影。再構成誤差で異常を判定。                           | 全ての基本。計算が極めて速く、多変量データの相関異常に強い。                                     |
| **RPCA** (Robust PCA)        | 2009年                               | 行列を「低ランク(L)」と「スパース(S)」に厳密に分解する数学的枠組み。                   | **外れ値に極めて強い。** 学習データに異常が混ざっていても、正しく背景を抽出できる。        |
| **ISTA / ADMM**              | 2000年代後半                         | RPCA等の最適化問題を解くための反復アルゴリズム。                                       | 数学的に「なぜその結果になるか」を1ステップずつ説明可能。                                        |
| **LISTA** (Learned ISTA)     | 2010年                               | ISTAの反復計算をニューラルネットワークの層として展開。                                 | **深層展開の先駆け。** 古典アルゴリズムの「正確さ」とDLの「速さ」を両立。                  |
| **DIP** (Deep Image Prior)   | 2018年                               | ニューラルネットワークの構造自体が「滑らかな背景」を生成するバイアスを持つことを利用。 | **事前学習(教師データ)が一切不要。** 1枚の画像だけで異常分離が可能。                       |
| **RPCANet / Deep Unfolding** | 2019年以降                           | RPCAのアルゴリズムを多層化し、パラメータをデータから学習。                             | **画像・時系列の複雑な模様に対応。** 従来のPCAでは不可能だった高度なテクスチャ分離を実現。 |

### 各手法の詳しい解説

#### 1. 古典的PCA (Principal Component Analysis)

* **特徴:** データの「主要な軸」を探します。
* **すごい点:** 100年以上前の理論ながら、現代でも工場のセンサーデータ分析の第一選択肢です。「いつもと違う組み合わせ」を瞬時に見抜きます。

#### 2. RPCA (Robust PCA)

* **特徴:** 従来のPCAが「外れ値」に引きずられて軸が歪む弱点を克服しました。
* **すごい点:** 監視カメラの映像から「動体（スパース）」と「背景（低ランク）」を分離するデモで世界に衝撃を与えました。キズ検知の数学的土台です。

#### 3. LISTA (Learned ISTA)

* **特徴:** 数式の繰り返し計算を「ニューラルネットワークの層」に置き換えました。
* **すごい点:** それまで100回計算が必要だった処理を、わずか数層のネットワークで実行可能にしました。 **「数学を効率化するAI」** という新しい概念を作りました。

#### 4. RPCANet (Deep Unfolding RPCA)

* **特徴:** あなたが実装に挑戦している手法です。RPCAの強力な分離能力を、深層学習の「柔軟なしきい値調整」で強化しています。
* **すごい点:** 金属表面の複雑な模様（NEU-Segなど）のように、従来の統計学では「ノイズ」と「キズ」の区別がつかなかった対象に対し、驚異的な分離精度を誇ります。

### どの手法を選ぶべきか？

* **データがシンプルで計算を軽くしたい:** **PCA**
* **数学的な根拠（なぜ異常と判定したか）を重視したい:** **RPCA / ISTA**
* **複雑なデータ（画像など）で、ラベルを使って最高精度を出したい:** **RPCANet / LISTA**

これらの手法はバラバラに見えて、実は「行列を L と S に分ける」という共通のゴールに向かって進化してきた仲間たちです。


## 異常データセット
異常を含むデータセットのうちインターネットに公開されているものは以下のものがあります。

1. [MVTec AD / MVTec AD 2](https://www.mvtec.com/company/research/datasets/mvtec-ad#:~:text=The%20MVTec%20anomaly%20detection%20dataset,Dataset%20for%20Unsupervised%20Anomaly%20Detection%22.)

特徴: 産業用異常検知のデファクトスタンダードです。金属、プラスチック、皮革などのテクスチャや、ケーブル、ネジなどの物体が含まれます。

傷の例: 表面の引っかき傷（scratch）、へこみ（dent）、ひび割れ（crack）などが高解像度で収録されており、ピクセル単位の正解マスクが提供されています。

2. [KolektorSDD / KolektorSDD2](https://www.vicos.si/resources/kolektorsdd2/)

特徴: 実際の電気部品の表面で発生した欠陥を収集したデータセットです。

傷の例: 微細な擦り傷や表面のムラなど、実世界の複雑な背景下での傷検知に適しています。

3. [NEU-DET (Northeastern University Surface Defect Database)](https://www.kaggle.com/datasets/yidazhang07/bridge-cracks-image)

特徴: 熱延鋼板の表面欠陥に特化したデータセットです。

傷の例: 鋼板表面の引っかき傷（scratches）を含む、6種類の典型的な工業欠陥が収録されています。



