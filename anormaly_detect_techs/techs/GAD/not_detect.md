GADがCRDで検出できた異常を見逃してしまったという結果は、グラフ理論の性質を考えると非常に興味深いケースです。

結論から言うと、**GADがCRDより一律に「弱い」わけではありませんが、GADには「構造的に異常を無視してしまう」独特の死角があります。**

CRDが検出できてGADが失敗した原因として考えられる、3つの主な理由を解説します。

---

### 1. 「背景コミュニティ」への誤った同化

これが最も可能性の高い原因です。GADはピクセル同士の「つながり」を重視します。

* **CRDの挙動** : 周囲の画素の線形結合でターゲットを説明しようとします。色が少しでも「素材（辞書）」として不自然であれば、再構成誤差（スコア）が上がります。
* **GADの弱点** : もし異常が「背景とは色が違うが、異常同士では色が非常に似ている」場合、異常ピクセル同士が強固なネットワーク（島）を作ってしまいます。
* **結果** : グラフ理論上、異常の塊がひとつの「安定したコミュニティ」として認識されると、それは「孤立」していないとみなされ、異常スコアが下がってしまいます。

---

### 2. **$k$**-NN（近傍数）による「馴れ合い」

GADの実装で設定した `n_neighbors` (**$k$**) が影響している可能性があります。

* **現象** : 異常のサイズがそれなりに大きい場合、`n_neighbors` の数よりも異常領域内のピクセル数の方が多いと、異常ピクセルは「自分に似た隣人（＝他の異常ピクセル）」を **$k$** 個見つけることができてしまいます。
* **影響** : グラフ上で異常ピクセルが背景から完全に切り離されず、自分たちの島の中で満足して繋がってしまうため、ラプラシアン行列の固有値解析において「背景の一部」や「別の正常な素材」として処理されてしまいます。

---

### 3. スペクトル埋め込み（次元圧縮）での情報喪失

GADは固有ベクトルを使って低次元空間に写像しますが、ここで「情報の捨て過ぎ」が起きることがあります。

* **CRDの強み** : 元の全バンド（高次元）の情報を保持したまま再構成誤差を計算します。
* **GADの弱点** : 固有値分解の過程で、上位数個の固有ベクトル（`n_components`）に情報を凝縮します。もし異常を示す特徴が、捨てられた下位の固有ベクトルに含まれていた場合、低次元空間では背景と異常が重なって見えてしまいます。

---

### どうすればGADの検出力を上げられるか？

もしCRDの結果に近づけたい、あるいは追い越したい場合は、以下の調整を試してみてください。

1. **`n_neighbors` を小さくする** :
   異常同士が繋がりにくくするために、エッジを張る数を最小限（例: 5〜8程度）に絞ります。
2. **空間距離に制約をかける** :
   「色が似ている」だけでなく「物理的に近くにいる」ものとしか繋げないように制限（空間カーネルの導入）すると、大きな異常が独立しやすくなります。
3. **バイポテンシャル（Bi-potential）グラフの採用** :
   単に似ているものを繋ぐだけでなく、背景の統計から外れているエッジを意図的に切断する重み付けを導入します。

### まとめ

* **CRD**は、**「色の整合性」**に厳格です（色使いが少しでも怪しければ検知）。
* **GAD**は、**「ネットワークの孤立度」**に注目します（群れていれば見逃す）。

CRDで検知できたその異常は、**「背景とは明らかに色が違うが、ある程度の面積（塊）を持っている」**ものではないでしょうか？ もしそうなら、GADはそれを「小さな新しい背景」と勘違いしてしまっている可能性が高いです。

この推測は、実際のデータの特徴と一致していますか？もしそうであれば、パラメータ調整の方向性をより具体的に提案できます。
