LRX（Local Reed-Xiaoli Detector）は、異常検知の古典的かつ強力なアルゴリズムである「RX検知器」を、CRDのように**局所的な窓（Local Window）**に限定して適用した手法です。

統計学的には、**「注目している画素が、周囲の平均的な分布からどれだけ外れているか」**を**マハラノビス距離**を用いて算出します。


### 1. 理論的背景：マハラノビス距離

LRXの根本にあるのは、背景のデータ分布が「多変量正規分布（ガウス分布）」に従うという仮定です。

単なるユーグリッド距離（色の差）と異なり、マハラノビス距離は**「背景データのバラツキ（相関）」**を考慮します。例えば、背景において「赤と黄色の変動はよくあること」であれば、その方向の色の差は異常とみなさず、逆に「青方向の変動は滅多にない」のであれば、わずかな青みの差を大きな異常として検出します。


### 2. LRXの計算手順

ターゲット画素  に対して、以下のステップで計算を行います。

#### ① 局所背景のサンプリング

CRDと同様に、二重窓（内窓と外窓）を用いて、ターゲットの周囲から背景画素の集合  を抽出します。

#### ② 統計量の算出

抽出した背景データ  の**平均ベクトル ** と **共分散行列 ** を計算します。

* : 背景の平均的な色・スペクトル
* : 背景の各バンド間（色間）の相関とバラツキ

#### ③ 異常スコア（LRX値）の計算

ターゲット  の異常度を以下の式で求めます。


この値が大きいほど、「背景の統計分布から大きく外れた異物」であると判定されます。


### 3. LRX vs CRD：何が違うのか？

どちらも局所窓を使いますが、**「背景をどうモデル化するか」**の哲学が異なります。

| 特徴 | LRX (統計モデル) | CRD (線形結合モデル) |
| --- | --- | --- |
| **考え方** | 背景の「分布（楕円）」からはみ出ているか | 背景を「混ぜて（合成）」再現できるか |
| **計算内容** | 平均と共分散行列の逆行列 | 背景画素の線形結合と再構成誤差 |
| **得意なこと** | 統計的な外れ値の検出 | 背景の複雑な混ざり合いの分離 |
| **弱点** | 背景が正規分布でないと精度が落ちる | 背景に異常が混ざると（汚染）極端に弱い |


### 4. LRXのメリットとデメリット

* **メリット**:
* **適応性が高い**: 場所ごとに統計量（平均・分散）を計算し直すため、画像内の明るさの変化やノイズの変化に非常に強いです。
* **実装が比較的容易**: 共分散行列を求めて逆行列を掛けるだけなので、アルゴリズムが明快です。


* **デメリット**:
* **計算負荷**: 全ピクセルで共分散行列の逆行列を求めるため、マルチスペクトル画像などバンド数が多いと非常に重くなります。
* **小サンプル問題**: 窓が小さすぎると背景画素数が足りず、共分散行列が正則（計算可能）にならず、エラー（特異行列）になることがあります。



### 5. まとめ

LRXは**「周囲の平均から浮いているか」**を測る手法です。
CRDが「背景を組み合わせてターゲットを**作る**」というアプローチなのに対し、LRXは「背景の**群れ**の中に馴染んでいるか」をチェックするアプローチと言えます。

実務では、**「まずLRXで統計的な外れ値を探し、その周辺をCRDやLRBで詳細に解析する」**といった使い分けがよくなされます。


