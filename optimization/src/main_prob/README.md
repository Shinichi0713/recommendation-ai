最適化における **「主問題（Primal Problem）」** と **「双対問題（Dual Problem）」** は、同じ山を「地上から見上げる（主）」か、「空から見下ろす（双対）」かという、表裏一体の関係にある2つのアプローチのことです。

RPCAや機械学習の文脈では、この考え方を使うことで、計算を効率化したり収束を判定したりします。

---

### 1. 主問題 (Primal Problem)

私たちが直接解きたい「本来の目的」そのものです。通常、制約条件を満たしながら、ある関数（目的関数）を最小化（または最大化）する形をとります。

* **直感的なイメージ**: 「予算の範囲内で、最も効果の高い広告の組み合わせを探す」
* **RPCAでの例**: 元の画像 $M$ を背景 $L$ と異常 $S$ に分けるとき、 **「$M = L + S$ というルールを守りつつ、$L$ のランクと $S$ のスパース性を最小にしたい」** というのが主問題です。

---

### 2. 双対問題 (Dual Problem)

主問題の制約条件を「ペナルティ」として目的関数に取り込み、別の変数（双対変数）を使って定義し直した問題です。

* **直感的なイメージ**: 「広告の効果を一定以上に保つために必要な、最小の追加予算（コスト）の見積もりを出す」
* **数学的な関係**: 主問題が「最小値」を探す問題なら、その双対問題は「最大値」を探す問題になります。

---

### 3. なぜ「双対」を考えるのか？（3つのメリット）

なぜわざわざ問題を裏返して考えるのかには、実利的な理由があります。

#### ① 下界（Lower Bound）を知るため

双対問題の解は、主問題の最小値がこれ以上小さくならないという「底（下限）」を教えてくれます。

#### ② 強双対性と「双対ギャップ」

特定の条件（凸最適化など）を満たすとき、**「主問題の最小値 ＝ 双対問題の最大値」**となります。これを**強双対性**と呼びます。

* このとき、両者の差を**双対ギャップ（Duality Gap）**と呼びます。
* 最適化の進捗中、このギャップが  に近づけば、「今持っている解が数学的に完璧な正解である」と確信できるのです。

#### ③ 計算が楽になる（カーネル法など）

主問題では変数の数が多くて計算が大変でも、双対問題に書き換えると変数が減ったり、行列の計算が単純になったりすることがあります。SVM（サポートベクターマシン）でカーネルトリックが使えるのは、この双対問題のおかげです。

---

### 4. RPCAにおける「双対」の役割

RPCAの実装でよく使われる **ALM（拡張ラグランジュ関数法）** は、まさにこの主問題と双対問題を同時に解いていく手法です。

1. 主変数 ($L, S$): 背景と異常を更新する（最小化を目指す）。
2. 双対変数 ($Y$): 制約 $M - L - S = 0$ からのズレに対する「重み」を更新する（最大化を目指す）。

この2つがキャッチボールを繰り返すことで、最終的に $M = L + S$ を満たしながら最適な分離を実現します。

### まとめ

* **主問題**: 「何（$L, S$）を最適化するか」に注目。
* **双対問題**: 「制約条件」をどう満たすかに注目。
* **双対ギャップ**: $0$ になれば最適化完了の合図。



