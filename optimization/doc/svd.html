<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>&#x6982;&#x8981;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}
/* 目次全体のコンテナ */
nav {
    background-color: #f8f9fa;
    border: 1px solid #e1e4e8;
    border-radius: 12px;
    padding: 24px;
    margin: 20px 0 40px 0;
    max-width: 600px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

/* 「目次」というタイトル */
nav h3 {
    margin-top: 0;
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 2px solid #0969da;
    color: #24292f;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
}

/* タイトルの前にアイコン（絵文字）を追加 */
nav h3::before {
    content: "📖";
    margin-right: 8px;
}

/* リストのスタイル調整 */
#toc {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

#toc li {
    margin-bottom: 8px;
    line-height: 1.4;
}

/* リンクのスタイル */
#toc a {
    color: #0969da;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.2s ease;
    display: inline-block;
}

#toc a:hover {
    color: #cf222e;
    transform: translateX(5px); /* ホバー時に少し右に動く */
}

/* h3（小見出し）がある場合のネスト表現（JSの修正も必要） */
.toc-h3 {
    padding-left: 20px;
    font-size: 0.9em;
    opacity: 0.8;
}


/* 記事タイトル (h1) */
h1 {
    font-size: 2rem;
    color: #24292f;
    line-height: 1.3;
    padding: 20px 0;
    margin-bottom: 30px;
    border-bottom: 3px double #e1e4e8; /* 二重線で上品に */
    text-align: center; /* タイトルを中央に寄せて特別感を出す */
}

/* セクション見出し (h2) */
h2 {
    font-size: 1.5rem;
    color: #24292f;
    padding: 0.5rem 1rem;
    margin: 40px 0 20px 0;
    background: linear-gradient(transparent 70%, #e8f0fe 70%); /* 下側に薄い色のアクセント */
    border-left: 6px solid #0969da; /* 目次のテーマカラーと合わせる */
    border-radius: 2px;
    display: flex;
    align-items: center;
}

/* 強調文字 (strong) */
strong {
    font-weight: bold;
    color: #cf222e; /* ホバー時の赤色と合わせて統一感を出す */
    background: linear-gradient(transparent 60%, #fff2cc 60%); /* 黄色のマーカー風 */
    padding: 0 2px;
}

/* 引用のコンテナ */
blockquote {
    position: relative;
    padding: 20px 30px;
    margin: 30px 0;
    background-color: #f6f8fa; /* 目次の背景より少しだけ濃いグレー */
    border-left: 5px solid #d0d7de; /* 落ち着いたグレーの境界線 */
    color: #57606a; /* 文字色は少し薄くして引用らしさを出す */
    font-style: italic;
    border-radius: 0 8px 8px 0;
}

/* 引用符のアイコンを装飾として追加 */
blockquote::before {
    content: "“";
    position: absolute;
    top: -5px;
    left: 10px;
    font-size: 40px;
    color: #d0d7de;
    font-family: serif;
    line-height: 1;
}

/* 読者になるボタンのデザイン */
.btn-subscribe {
    display: inline-block;
    padding: 12px 35px; /* 横幅を広めにとって存在感を出します */
    background-color: #383838; /* お好みの色に変更してください */
    color: #ffffff !important;
    text-decoration: none;
    border-radius: 4px;
    font-weight: bold;
    transition: 0.3s;
}

.btn-subscribe:hover {
    background-color: #555555;
    text-decoration: none;
}

/* はてなブログで見えてしまう数式データを非表示にする */
.katex-mathml {
    display: none !important;
}
</style>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">

<nav>
        <h3>目次</h3>
        <ul id="toc"></ul> 
</nav>


            <p>本日は、コンピュータ科学において　<strong>「複雑で高次元なデータから、本質的なパターン（構造）を取り出す最強のツール」</strong>　として活用されている特異値分解（Singular Value Decomposition, <strong>SVD</strong>）について説明します。</p>
<h2 id="概要">概要</h2>
<p>特異値分解は、一言でいえば <strong>「どんな形の行列でも、3つの意味のある行列の掛け算に分解する」</strong> という数学的な処理です。</p>
<p>データ分析や画像圧縮、AIの分野で非常に重宝される手法で、「行列のDNAを取り出す」ような作業だとイメージすると分かりやすいです。</p>
<h3 id="1-数学的な定義">1. 数学的な定義</h3>
<p>任意の <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> 行列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> は、以下の3つの行列の積に分解できます。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><mi mathvariant="normal">Σ</mi><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">A = U \Sigma V^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">Σ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>それぞれの行列には以下の役割があります。</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> (左特異ベクトル): 出力側の空間における「基底（軸）」を表します。データの「列」方向の特徴を捉えます。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span> (特異値行列): 対角成分に「特異値」が並んだ行列です。特異値は**「その軸がどれだけ重要か（データの大きさ・情報の濃さ）」**を表します。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">V^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> (右特異ベクトル): 入力側の空間における「基底（軸）」を表します。データの「行」方向の特徴を捉えます。</li>
</ul>
<h3 id="2-直感的なイメージ多次元の回転と引き伸ばし">2. 直感的なイメージ：多次元の回転と引き伸ばし</h3>
<p>幾何学的には、SVDは行列による変換を <strong>「回転 → 拡大縮小 → 回転」</strong> という3つのステップに分解していると解釈できます。</p>
<ol>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">V^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>: データを回転させ、扱いやすい向きに揃える。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>: 重要な方向にデータを引き伸ばし、不要な方向を縮める。</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>: 再び回転させ、元の空間に戻す。</li>
</ol>
<p>どんなに複雑な行列の動きも、この3段階で説明できるというのがSVDの凄さです。</p>
<h3 id="3-主な用途何に役立つのか">3. 主な用途（何に役立つのか？）</h3>
<p>SVDが最も力を発揮するのは、 <strong>「膨大なデータから本質的な情報だけを抜き出す（低ランク近似）」</strong> ときです。</p>
<ul>
<li><strong>画像圧縮:</strong> 特異値の大きなもの（重要な情報）だけを残し、小さなもの（ノイズや細かいディテール）を捨てて再構成すると、見た目を維持したままデータ量を大幅に削減できます。</li>
<li><strong>推薦システム（レコメンド）:</strong> 「ユーザー × 商品」の巨大な行列を分解することで、ユーザーの潜在的な「好み」や商品の「特徴」を抽出し、似た商品を勧めることができます。</li>
<li><strong>次元圧縮 (PCAの基盤):</strong> 多変量解析でよく使われる主成分分析（PCA）は、内部的にこのSVDと同じ計算を行っています。</li>
</ul>
<h3 id="4-線形最適化とのつながり">4. 線形最適化とのつながり</h3>
<p>前にお話しした「最適化」の観点では、SVDは <strong>「最小二乗法」</strong> や <strong>「擬似逆行列」</strong> の計算に使われます。行列  が正方行列でなかったり、逆行列を持たなかったりする場合でも、SVDを使えば「最も誤差が小さい解」を安定して求めることができます。</p>
<h2 id="応用例">応用例</h2>
<h3 id="1-機械学習とデータマイニング">1. 機械学習とデータマイニング</h3>
<p>SVDは「データの要約」において中心的な役割を果たします。</p>
<ul>
<li><strong>次元圧縮 (PCA):</strong> 主成分分析（PCA）の計算の核心部分はSVDです。数千もの変数があるデータから、最も重要な数個の軸（主成分）を選び出し、データを可視化したり計算コストを下げたりします。</li>
<li><strong>潜在意味解析 (LSA):</strong> 自然言語処理の初期において、文書と単語の行列をSVDで分解し、「どの単語がどのトピック（潜在的な意味）に近いか」を計算するのに使われました。</li>
<li><strong>レコメンデーション（推薦システム）:</strong> NetflixやAmazonのような「ユーザー × 商品」の巨大な行列から、ユーザーの隠れた好みや商品の隠れた特徴を抽出するのに使われます。</li>
</ul>
<h3 id="2-画像処理とコンピュータビジョン">2. 画像処理とコンピュータビジョン</h3>
<p>画像は行列そのものであるため、SVDと非常に相性が良いです。</p>
<ul>
<li><strong>画像圧縮:</strong> 特異値（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>）は情報の重要度を表します。大きな特異値だけを残して小さな値をゼロにすることで、見た目をほとんど変えずにファイルサイズを劇的に小さくできます。</li>
<li><strong>ノイズ除去:</strong> 画像に含まれるランダムなノイズは、通常小さな特異値として現れます。これを取り除くことで、画像を滑らかに復元できます。</li>
<li><strong>顔認識 (Eigenfaces):</strong> 多数の顔画像をSVDで分解し、「顔の基本パーツ（固有顔）」を取り出すことで、少ないデータで個人を特定する技術に使われました。</li>
</ul>
<h3 id="3-数値計算と信号処理">3. 数値計算と信号処理</h3>
<p>計算の安定性を高めるための「守護神」的な役割です。</p>
<ul>
<li><strong>擬似逆行列の計算:</strong> 逆行列が存在しない（行列式が0の）行列に対しても、SVDを使えば「もっともらしい解」を導くための擬似逆行列（ムーア・ペンローズ逆行列）を求めることができます。</li>
<li><strong>最小二乗法:</strong> 線形回帰などで誤差を最小にするパラメータを求める際、行列の状態が悪い（数値的に不安定な）場合でも、SVDを使えば安定して解くことができます。</li>
</ul>
<h3 id="4-検索エンジンと情報検索">4. 検索エンジンと情報検索</h3>
<p>情報の関連性を計算する基礎技術です。</p>
<ul>
<li><strong>PageRankの周辺技術:</strong> GoogleのPageRankそのものは固有値計算に近いですが、Webサイト間のリンク構造を解析し、信頼性の高いハブサイトを見つける手法（HITSアルゴリズムなど）ではSVD的な考え方が使われます。</li>
</ul>
<h3 id="5-量子計算量子コンピュータ">5. 量子計算（量子コンピュータ）</h3>
<p>最先端の分野でもSVDは不可欠です。</p>
<ul>
<li><strong>量子もつれの解析:</strong> 量子状態を表す行列をSVDで分解することで、粒子同士がどれだけ強く「もつれて」いるかを測定する「シュミット分解」という手法に直接使われます。</li>
</ul>
<h2 id="なぜこれほど多用されるのか">なぜこれほど多用されるのか？</h2>
<p>コンピュータ科学においてデータは「行列」として扱われます。SVDは、その行列がどんなにボロボロ（正方形でない、逆行列がない、ノイズだらけ）であっても、 <strong>「ここが情報の核心だ」という部分を確実に抜き出してくれる</strong> ため、あらゆるアルゴリズムの下支えとなっているのです。</p>
<h3 id="行列から本質的な理由を抽出できる">行列から本質的な理由を抽出できる</h3>
<p>SVDが「行列の本質」を引き出せると言われる理由は、行列が持つ複雑な変化を、「向き（回転）」と「強さ（拡大）」に完全に切り分け、重要度順に並べ替えるからです。</p>
<p><strong>1. 情報を「寄与度（エネルギー）」の順に並べる</strong></p>
<p>SVDの最大の特徴は、分解された中間行列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>（特異値行列）にあります。</p>
<ul>
<li>特異値は必ず 値の大きい順（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>σ</mi><mn>2</mn></msub><mo>≥</mo><mo>⋯</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma_1 \ge \sigma_2 \ge \dots \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>） に並びます。</li>
<li>特異値の大きさは、その成分が元の行列の「情報量（バリアンス）」をどれだけ保持しているかを表します。</li>
</ul>
<p>つまり、**「大きな値＝本質的な構造」「小さな値＝ノイズや微細なディテール」**と数学的に明確にランク付けされるため、上位数個の成分だけを見ることで本質が見えるようになります。</p>
<p><strong>2. 「データの相関」を解消する（直交化）</strong></p>
<p>生のデータ（行列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>）は、各要素が互いに複雑に絡み合っています。SVDはこれを「直交するベクトル」に分解します。</p>
<ul>
<li>右特異ベクトル <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>:</li>
</ul>
<p>入力データの「隠れたパターン（主成分）」を、互いに混ざり合わない（直交する）独立した軸として抽出します。</p>
<ul>
<li>左特異ベクトル <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>:</li>
</ul>
<p>そのパターンが、出力結果（観測データ）においてどのような形状で現れるかを独立した軸で示します。</p>
<p>データ同士の「かぶり（冗長性）」を削ぎ落とし、純粋な要素だけにバラバラにするため、本質が浮き彫りになります。</p>
<p><strong>3. 低ランク近似（情報の取捨選択）</strong></p>
<p>SVDは、行列 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> を「1ランク行列（1つのベクトルと1つのベクトルの積）」の足し算として表現します。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>σ</mi><mn>1</mn></msub><msub><mi mathvariant="bold">u</mi><mn>1</mn></msub><msubsup><mi mathvariant="bold">v</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi>σ</mi><mn>2</mn></msub><msub><mi mathvariant="bold">u</mi><mn>2</mn></msub><msubsup><mi mathvariant="bold">v</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>σ</mi><mi>n</mi></msub><msub><mi mathvariant="bold">u</mi><mi>n</mi></msub><msubsup><mi mathvariant="bold">v</mi><mi>n</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">A = \sigma_1 \mathbf{u}_1 \mathbf{v}_1^T + \sigma_2 \mathbf{u}_2 \mathbf{v}_2^T + \dots + \sigma_n \mathbf{u}_n \mathbf{v}_n^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>第一項（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> の項）は、行列の中で最も支配的なパターン（大枠の形）です。</li>
<li>第二項、第三項と進むにつれて、細かい修正情報になります。</li>
</ul>
<p>この性質により、「計算を途中で打ち切る」だけで、ノイズを除去した「最も本質に近い近似行列」を作ることが可能になります。これが画像圧縮やノイズ除去ができる理由です。</p>
<h2 id="実験">実験</h2>
<p>実際にSVDを行うことで、ランクで分離→低ランクに画像の情報が凝縮されているということを実験してみようと思います。</p>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_sample_image

<span class="hljs-comment"># 1. サンプル画像の読み込みとグレースケール変換</span>
<span class="hljs-comment"># (行列として扱いやすくするため)</span>
flower = load_sample_image(<span class="hljs-string">&quot;flower.jpg&quot;</span>)
image = np.mean(flower, axis=<span class="hljs-number">2</span>) / <span class="hljs-number">255.0</span>  <span class="hljs-comment"># 0-1の範囲に正規化</span>

<span class="hljs-comment"># 2. 特異値分解 (SVD) の実行</span>
<span class="hljs-comment"># U: 左特異ベクトル, s: 特異値(重要度), Vh: 右特異ベクトル</span>
U, s, Vh = np.linalg.svd(image, full_matrices=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># 3. 異なる「ランク（保持する特異値の数）」で画像を再構成</span>
ranks = [<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">200</span>]
plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">8</span>))

<span class="hljs-comment"># 元の画像を表示</span>
plt.subplot(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>)
plt.imshow(image, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)
plt.title(<span class="hljs-string">&quot;Original Image (Full Rank)&quot;</span>)
plt.axis(<span class="hljs-string">&#x27;off&#x27;</span>)

<span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ranks):
    <span class="hljs-comment"># 上位k個の特異値のみを使用して行列を再構成</span>
    <span class="hljs-comment"># A_approx = U[:, :k] @ diag(s[:k]) @ Vh[:k, :]</span>
    image_approx = np.dot(U[:, :k] * s[:k], Vh[:k, :])
    
    plt.subplot(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, i + <span class="hljs-number">2</span>)
    plt.imshow(image_approx, cmap=<span class="hljs-string">&#x27;gray&#x27;</span>)
    plt.title(<span class="hljs-string">f&quot;Rank <span class="hljs-subst">{k}</span> Approximation&quot;</span>)
    plt.axis(<span class="hljs-string">&#x27;off&#x27;</span>)

<span class="hljs-comment"># 4. 特異値の減衰をプロット（情報の集中度を確認）</span>
plt.subplot(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>)
plt.plot(s[:<span class="hljs-number">100</span>], color=<span class="hljs-string">&#x27;red&#x27;</span>)
plt.title(<span class="hljs-string">&quot;Singular Value Spectrum&quot;</span>)
plt.xlabel(<span class="hljs-string">&quot;Index&quot;</span>)
plt.ylabel(<span class="hljs-string">&quot;Value&quot;</span>)

plt.tight_layout()
plt.show()
</code></pre>
<h3 id="実験結果">実験結果</h3>
<ol>
<li>情報の優先順位付け（Rank 2 vs Rank 200）</li>
</ol>
<p>グラフの右下にある &quot;Singular Value Spectrum&quot; を見てください。特異値は最初が非常に大きく、急激に小さくなっています。これは、 <strong>「最初の数個の成分に、画像の情報の大部分（輪郭や大きな明暗差）が集中している」</strong> ことを示しています。</p>
<p><img src="file:///d:\PycharmProjects\ScienceCalculation\recommendation-ai\optimization\doc\image\svd\1768643994508.png" alt="1768643994508"></p>
<ol start="2">
<li>Rankの抽出結果</li>
</ol>
<p>画像から Rank数が 2, 10, 50, 200　のものを特異値行列から再構成しました。</p>
<p>Rank 2: わずか2つの成分だけでも、なんとなく花の形がわかります。</p>
<p>Rank 50: 50個の成分があれば、人間にはほぼ元の画像と区別がつかないレベルになります。</p>
<p>つまり上位の特異値があれば、残り僅かな特異値の要素はなくても、ほぼ元の画像を復元しているということが分かります。</p>
<p><img src="file:///d:\PycharmProjects\ScienceCalculation\recommendation-ai\optimization\doc\image\svd\1768643967918.png" alt="1768643967918"></p>
<p><img src="file:///d:\PycharmProjects\ScienceCalculation\recommendation-ai\optimization\doc\image\svd\1768643977796.png" alt="1768643977796"></p>
<h2 id="所感">所感</h2>
<p>本日は行列処理の中でも、中にある情報の本質を綺麗に並べ替える特異値分解を扱いました。</p>
<p>特異値分解は異常検知や、レコメンデーションシステムで活用され、重要な情報のピックアップという面で有用です。</p>
<p>数学を扱い、大きな情報を圧縮してみたい、本質に絞りたいという時に活用下さい。</p>

            <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>

<h2>最後に</h2>
<p>記事を最後まで読んでくださってありがとうございます。<br />記事の内容を読んで頑張れと思っていただいた読者様、是非、読者になって今後も応援してください。</p>
<iframe src="https://blog.hatena.ne.jp/yoshishinnze/yoshishinnze.hatenablog.com/subscribe/iframe" allowtransparency="true" frameborder="0" scrolling="no" width="150" height="28"></iframe>

<script>
const toc = document.getElementById('toc');
// h2 と h3 の両方を取得
const headings = document.querySelectorAll('h2, h3');

headings.forEach((heading, i) => {
    if (!heading.id) heading.id = `heading-${i}`;
    
    const li = document.createElement('li');
    const link = document.createElement('a');
    link.href = `#${heading.id}`;
    link.textContent = heading.textContent;
    
    // h3 の場合はクラスを付与して字下げする
    if (heading.tagName === 'H3') {
        li.classList.add('toc-h3');
    }
    
    li.appendChild(link);
    toc.appendChild(li);
});

// スムーズスクロールを有効にする
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
</script>


        </body>
        </html>