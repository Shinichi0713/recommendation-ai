
## 連立方程式

これまでの「線形写像」「行列式」「逆行列」という武器がすべて繋がる瞬間が、 **連立方程式（System of equations）** の解決です。

数学的には、連立方程式を解くことは **「変身した後の姿から、元の姿を逆算する」** というパズルを解くことと同じです。

### 1. 連立方程式を行列の形で書く

例えば、以下のような中学生でも解ける連立方程式を考えます。

$$\begin{cases}
2x + y = 5 \\
x + 3y = 10
\end{cases}$$

これを行列とベクトルの形に整理すると、こう書けます。

$$\begin{pmatrix} 2 & 1 \\ 1 & 3 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 5 \\ 10 \end{pmatrix}$$

これを抽象化して記号で書くと、非常にシンプルになります。

$$A\mathbf{x} = \mathbf{b}$$

- $A$：係数行列（空間をどう変形させるかの指示書）
- $\mathbf{x}$：未知数ベクトル（知りたい「元の姿」）
- $\mathbf{b}$：定数ベクトル（変身した後の「今の姿」）


### 2. 逆行列を使って「逆再生」する

方程式 $A\mathbf{x} = \mathbf{b}$ を解くとは、$\mathbf{x}$ を単独にすることです。普通の数式なら「$A$ で割る」ところですが、行列には割り算がない代わりに逆行列 $A^{-1}$ を使います。

両辺の左から $A^{-1}$ を掛けてみます。

1. $A^{-1}(A\mathbf{x}) = A^{-1}\mathbf{b}
2. $$(A^{-1}A)\mathbf{x} = A^{-1}\mathbf{b}$　（結合法則）
3. $I\mathbf{x} = A^{-1}\mathbf{b}$　（逆行列の定義より、掛けると単位行列 $I$ になる）
4. $\mathbf{x} = A^{-1}\mathbf{b}$

つまり、 **「逆行列（逆再生の魔法）」を「今の姿 」に掛けるだけ** で、勝手に元の答え  が導き出されます。

### 3. 行列式の役割：解けるかどうかの門番

ここで **行列式$\det(A)$** が重要になります。先ほどの逆行列の公式を思い出してください。

$$A^{-1} = \frac{1}{\det(A)} \text{adj}(A)$$

分母に $\det(A)$ がいますね。もし $\det(A) = 0$ だったらどうなるでしょうか？
数学では $0$ で割ることはできないため、逆行列が作れず、この方法は使えません。

- $\det(A) \neq 0$ のとき： 空間が潰れていないので、唯一の解 $\mathbf{x}$ が見つかる。
- $\det(A) = 0$ のとき： 空間が線や点に潰れている。変身後の $\mathbf{b}$ がその線上になければ「解なし」、線上にあれば「解が無限にある（特定できない）」状態になる。


### 4. まとめ：連立方程式を解くストーリー

以上のことを踏まえて連立方程式を線形代数を用いて解く流れについて説明します。

1. **行列で表現：** $A\mathbf{x} = \mathbf{b}$ と整理する。
2. **行列式をチェック：**  $\det(A) \neq 0$ か確認する（空間が潰れていないか？）。
3. **逆行列を生成：** 余因子行列などを使って $A^{-1}$ を作る。
4. **逆再生：** $A^{-1}$ を $\mathbf{b}$ に掛けて、答え $\mathbf{x}$ を得る。

これが、行列の理論を使った連立方程式のスマートな解法です。

### 5. クラメールの公式

**クラメールの公式（Cramer's rule）**　は、連立一次方程式の解を、行列式だけを使って直接求めることができる非常に美しい公式です。

これまでの「行列式」の意味（空間の拡大率・面積）を理解していれば、この公式がなぜ成り立つのかを幾何学的にスッキリと理解できます。

__1. 公式の形__

連立方程式 $A\mathbf{x} = \mathbf{b}$ において、行列 $A$ が正則（$\det(A) \neq 0$）であるとき、各未知数 $x_i$ は次のように求められます。

$$x_i = \frac{\det(A_i)}{\det(A)}$$

ここで、$A_i$ とは **「行列 $A$ の第 $i$ 列目を、右辺の定数ベクトル $\mathbf{b}$ で置き換えた行列」** のことです。

__2. 幾何学的な直感：面積の比率__

2次元の例（$x_1, x_2$ を求める）で、なぜこれで解が出るのかを考えてみましょう。方程式は、基底の行き先 $f(\mathbf{e}_1), f(\mathbf{e}_2)$ を使って次のように書けます。

$$x_1 f(\mathbf{e}_1) + x_2 f(\mathbf{e}_2) = \mathbf{b}$$

ここで、$f(\mathbf{e}_1)$ と $\mathbf{b}$ が作る平行四辺形の面積を考えてみます。$\mathbf{b}$ を上の式で置き換えると：

$$\text{Area}(f(\mathbf{e}_1), \mathbf{b}) = \text{Area}(f(\mathbf{e}_1), x_1 f(\mathbf{e}_1) + x_2 f(\mathbf{e}_2))$$

平行四辺形の性質（同じ方向のベクトルを足しても面積は変わらない）を使うと、第1項の $x_1 f(\mathbf{e}_1)$ は消えてしまい、残るのは：

$$\text{Area}(f(\mathbf{e}_1), \mathbf{b}) = x_2 \cdot \text{Area}(f(\mathbf{e}_1), f(\mathbf{e}_2))$$

これを整理すると、$x_2 = \frac{\text{Area}(f(\mathbf{e}_1), \mathbf{b})}{\text{Area}(f(\mathbf{e}_1), f(\mathbf{e}_2))}$ となります。
分母は元の行列式 $\det(A)$、分子は2列目を $\mathbf{b}$ に入れ替えた行列式 $\det(A_2)$ です。

> **結論：** 未知数 $x_i$ とは、「ターゲットのベクトル $\mathbf{b}$ が、その方向の基底をどれくらい引き伸ばしたか」という比率を計算していることになります。

__3. 具体的な計算例__

次の連立方程式を解いてみます。

$$\begin{cases}
2x + y = 5 \\
x + 3y = 10
\end{cases}
\implies A = \begin{pmatrix} 2 & 1 \\ 1 & 3 \end{pmatrix}, \mathbf{b} = \begin{pmatrix} 5 \\ 10 \end{pmatrix}$$

1. **全体の行列式：** $\det(A) = (2 \times 3) - (1 \times 1) = 5$
2. **$x$ を求めるための分子：**  1列目を $\mathbf{b}$ に置換

$$\det(A_1) = \det\begin{pmatrix} \mathbf{5} & 1 \\ \mathbf{10} & 3 \end{pmatrix} = (5 \times 3) - (1 \times 10) = 5 \implies x = \frac{5}{5} = 1$$

3. **$y$ を求めるための分子：** 2列目を $\mathbf{b}$ に置換

$$\det(A_2) = \det\begin{pmatrix} 2 & \mathbf{5} \\ 1 & \mathbf{10} \end{pmatrix} = (2 \times 10) - (5 \times 1) = 15 \implies y = \frac{15}{5} = 3$$

__4. クラメルの公式のメリットとデメリット__

* **メリット：** 特定の変数（例えば $x$ だけ）を知りたいときに、他の変数を計算せずに直接求められる。
* 公式が成分のみで書かれているため、理論的な解析や証明に強い。


* **デメリット：**
* 行列が大きくなると、行列式の計算回数が膨大になり、コンピュータでの計算効率（速度）は**掃き出し法（ガウス消去法）に完敗**します。



