## 行列のベクトル化

行列をそのまま扱うと、数値の塊のトレースが出来なくなることがあります。
そこで行列を細かく分割して、トレースしやすくします。
この際に縦方向、横方向のブロック化が良く行われ、それぞれ**行ベクトル**と**列ベクトル**と呼ばれます。

これらを意識して使い分けることは、単なる計算上のルールではなく、**「データをどの視点から分析するか」**という分析の見通しがしやすくなります。

### 1. 定義：ブロックの「切り出し方」

行列 $A$ を $m \times n$ の数字の塊としたとき、切り出し方によって呼び名が変わります。

#### 列ベクトル (Column Vector)

行列を **「縦に細長く」** 切り出したものです。

$$\mathbf{a}_j = \begin{pmatrix} a_{1j} \\ a_{2j} \\ \vdots \\ a_{mj} \end{pmatrix}$$

* **イメージ:** 列ベクトルが横に $n$ 本並んで行列を構成していると考えます。
* **数学的な標準:** 通常、単に「ベクトル」と言えばこの列ベクトルを指すのが一般的です。

#### 行ベクトル (Row Vector)

行列を **「横に細長く」** 切り出したものです。

$$\mathbf{r}_i = \begin{pmatrix} a_{i1} & a_{i2} & \cdots & a_{in} \end{pmatrix}$$

* **イメージ:**  行ベクトルが縦に $m$ 本積み重なって行列を構成していると考えます。

### 2. ベクトルを用いることによる利便性

これらを使い分ける最大の利点は、 **「複雑な行列計算を、意味のある小さな単位に分解できる」** 点にあります。

#### ① 列ベクトルの利便性：写像の「行き先」がわかる

行列 $A$ にベクトル $\mathbf{x}$ を掛ける計算 ($A\mathbf{x}$) を、「列ベクトルの組み合わせ」として捉え直せます。

* **考え方:** $A\mathbf{x}$ は、「$A$ の各列ベクトルを、$\mathbf{x}$ の成分の比率で混ぜ合わせたもの」になります。
* **利点:** これにより、 **「この行列（写像）を通すと、空間がどの方向に引き伸ばされるか」** が直感的にわかります。AI（線形結合）の計算はこの視点で行われます。

#### ② 行ベクトルの利便性：データの「共通点（重み）」が見える

行列の各行を、一つの「フィルター」や「観測ルール」として捉えます。

* **考え方:** 内積計算は「行ベクトル  列ベクトル」の形になります。
* **利点:** 例えば、行ベクトルを「アンケートの評価項目」、列ベクトルを「ある回答者のデータ」とすれば、掛け算の結果は「その人の総合スコア」になります。 **「多次元のデータから一つの特徴を抽出する」** 際に非常に便利です。

#### ③ プログラミングとメモリの効率

コンピュータ上では、行列は「行ごとに並べる（行優先）」か「列ごとに並べる（列優先）」かのどちらかでメモリに保存されます。

* 自分の計算が「行」を頻繁に使うなら「行優先」で保存されたデータを使う、といった具合に、**計算速度を最大化する設計**が可能になります。


## 行列和積

行列の「和（足し算）」と「積（掛け算）」は、計算のルールが全く異なります。

これまでに学んだ **「数字のブロック」** という視点で見ると、和は「ブロック同士の重ね合わせ」、積は「写像の連続実行（合成）」という明確な意味を持っています。


### 1. 行列の和（Addition）

行列の和は非常にシンプルです。 **「同じ位置にある数字同士」** を足すだけです。

#### 計算のルール

2つの行列 $A$ と $B$ のサイズ（行と列の数）が完全に一致している必要があります。

$$A = \begin{pmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{pmatrix}, \quad B = \begin{pmatrix} b_{11} & b_{12} \\ b_{21} & b_{22} \end{pmatrix}$$

$$A + B = \begin{pmatrix} a_{11} + b_{11} & a_{12} + b_{12} \\ a_{21} + b_{21} & a_{22} + b_{22} \end{pmatrix}$$

* **意味:** 2つの異なる「変化（写像）」を、単純に足し合わせることを意味します。
* **引き算:** $A - B$ も同様に、同じ位置の要素を引くだけです。

以下の2つの行列 $A$ と $B$ を足します。

$$A = \begin{pmatrix} 1 & 3 \\ 5 & 2 \end{pmatrix}, \quad B = \begin{pmatrix} 4 & 1 \\ 0 & 6 \end{pmatrix}$$

__計算手順__

同じ位置（同じ行・同じ列）にある数字を単純に足し合わせます。

左上: $1 + 4 = 5$
右上: $3 + 1 = 4$
左下: $5 + 0 = 5$
右下: $2 + 6 = 8$

$$A + B = \begin{pmatrix} 1+4 & 3+1 \\ 5+0 & 2+6 \end{pmatrix} = \begin{pmatrix} 5 & 4 \\ 5 & 8 \end{pmatrix}$$

### 2. 行列の積（Multiplication）

積の計算は少し特殊で、 **「左側の行列の行」と「右側の行列の列」** を組み合わせて計算します。これを「内積（ドット積）」の繰り返しと捉えます。

#### 計算のルール

行列 $A$ ($m \times n$) と行列 $B$ ($n \times p$) を掛ける場合、「左の列数」と「右の行数」が一致 ($n$) していなければなりません。

$$A = \begin{pmatrix} \color{red}{a_{11}} & \color{red}{a_{12}} \\ a_{21} & a_{22} \end{pmatrix}, \quad B = \begin{pmatrix} \color{blue}{b_{11}} & b_{12} \\ \color{blue}{b_{21}} & b_{22} \end{pmatrix}$$

$$AB = \begin{pmatrix} (\color{red}{a_{11}}\color{blue}{b_{11}} + \color{red}{a_{12}}\color{blue}{b_{21}}) & (a_{11}b_{12} + a_{12}b_{22}) \\ (a_{21}b_{11} + a_{22}b_{21}) & (a_{21}b_{12} + a_{22}b_{22}) \end{pmatrix}$$


次に、以下の $A$ と $B$ を使って積 $AB$ を求めます。

ここが線形代数で最もミスが起きやすい **「左の行 × 右の列」** の計算です。

$$A = \begin{pmatrix} \color{red}{1} & \color{red}{3} \\ \color{green}{5} & \color{green}{2} \end{pmatrix}, \quad B = \begin{pmatrix} \color{blue}{4} & \color{orange}{1} \\ \color{blue}{0} & \color{orange}{6} \end{pmatrix}$$

__計算手順（4箇所の数字を出す）__

行列の積の結果 $C = AB$ の各成分を一つずつ作ります。

__① 左上の成分（Aの1行目 × Bの1列目）__

横向きの $(1, 3)$ と 縦向きの $(4, 0)$ を掛けて足します。

$$(\color{red}{1} \times \color{blue}{4}) + (\color{red}{3} \times \color{blue}{0}) = 4 + 0 = \mathbf{4}$$


__② 右上の成分（Aの1行目 × Bの2列目）__

横向きの $(1, 3)$ と 縦向きの $(1, 6)$ を掛けて足します。

$$(\color{red}{1} \times \color{orange}{1}) + (\color{red}{3} \times \color{orange}{6}) = 1 + 18 = \mathbf{19}$$


__③ 左下の成分（Aの2行目 × Bの1列目）__

横向きの $(5, 2)$ と 縦向きの $(4, 0)$ を掛けて足します。

$$(\color{green}{5} \times \color{blue}{4}) + (\color{green}{2} \times \color{blue}{0}) = 20 + 0 = \mathbf{20}$$


__④ 右下の成分（Aの2行目 × Bの2列目）__

横向きの $(5, 2)$ と 縦向きの $(1, 6)$ を掛けて足します。

$$(\color{green}{5} \times \color{orange}{1}) + (\color{green}{2} \times \color{orange}{6}) = 5 + 12 = \mathbf{17}$$

__最終的な結果__

$$AB = \begin{pmatrix} 4 & 19 \\ 20 & 17 \end{pmatrix}$$

#### なぜ「行 × 列」なのか？（写像の視点）

行列の積 $AB$ は、 **「まず $B$ という写像を通し、その結果に $A$ という写像を通す」** という、処理の連続（合成）を表しています。

1. 入力ベクトルがまず $B$ の「列（新しい軸）」によって変換される。
2. その結果を $A$ の「行（フィルター）」が受け取る。

この「出力が次の入力になる」という流れを数式にまとめると、必然的にこの「行 × 列」の形になります。


### 3. 積の計算における重要な注意点

普通の数字の掛け算（$2 \times 3 = 3 \times 2$）とは異なり、行列の積には以下の特徴があります。

* **交換法則が成り立たない:** 一般的に **$AB \neq BA$** です。
* 例：「90度回転させてから、横に引き伸ばす」のと「横に引き伸ばしてから、90度回転させる」のでは、最終的な形が変わるのと同じです。


* **ゼロ因子が存在する:**  $A \neq 0$ かつ $B \neq 0$ なのに、積 $AB = 0$（すべての要素が0）になることがあります。
* 例：ある方向に空間をペシャンコに潰すマシンを2つ組み合わせると、最終的に何も残らなくなるケースです。




